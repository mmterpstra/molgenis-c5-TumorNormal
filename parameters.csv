################################################################################
##general pipeline parameters
#
#longQueue,ll
#queue=longQueue
queue,ll
mem,4
walltime,23:59:00
nodes,1
ppn,1
defaultInterpreter,#!/bin/bash
stage,module load
checkStage,module list
#WORKDIR,/gcc/
#root,${WORKDIR}
group,gcc
tmp,tmp04
data,/apps/data/
software,/apps/software/
projectDir,/groups/${group}/${tmp}/projects/${project}/
################################################################################
##module parameters
#
fastqcMod,FastQC/0.11.3-Java-1.7.0_80
bwaMod,BWA/0.7.12-goolf-1.7.20
picardMod,picard/1.130-Java-1.7.0_80
RMod,R/3.2.1-goolf-1.7.20
gatkMod,GATK/3.5-Java-1.7.0_80
#gatkMod,GATK/3.4-0-Java-1.7.0_80
snpEffMod,snpEff/4.1d-Java-1.7.0_80
varScanMod,VarScan/2.4.0-Java-1.7.0_80
samtoolsMod,SAMtools/0.1.18-goolf-1.7.20
vcfToolsMod,VCFtools/0.1.12b-goolf-1.7.20-Perl-5.20.2-bare
pipelineUtilMod,pipeline-util
tableToXlsxMod,TableToXlsx
digiRgMod,DigitalBarcodeReadgroups/0.1.2-goolf-1.7.20-Perl-5.20.2-bare
bbmapMod,BBMap/35.69-Java-1.7.0_80
bedtoolsMod,BEDTools/2.23.0-goolf-1.7.20
hisat2Mod,hisat2/2.0.3-beta-goolf-1.7.20
htseqMod,HTSeq/0.6.1p1
################################################################################
##Reference Data
#
genomeLatSpecies,Homo_sapiens
genomeSpecies,human
genomeBuild,b37
genomeGrchBuild,GRCh37
ensemblVersion,75
bundle,${data}/ftp.broadinstitute.org/bundle/2.8/${genomeBuild}/
#onekgGgenomeDecoyFasta,${resDir}/${genomeBuild}/indices/human_g1k_v37_decoy.fasta
onekgGenomeFasta,${bundle}/human_g1k_v37_decoy.fasta
onekgGenomeFastaIdxBase,${bundle}/${bwaMod}/human_g1k_v37_decoy.fasta
onekgGenomeFastaDict,${bundle}/human_g1k_v37_decoy.dict

goldStandardVcf,${bundle}/Mills_and_1000G_gold_standard.indels.b37.vcf
goldStandardVcfIdx,${goldStandardVcf}.idx

oneKgPhase1SnpsVcf,${bundle}/1000G_phase1.snps.high_confidence.b37.vcf
oneKgPhase1SnpsVcfIdx,${oneKgPhase1SnpsVcf}.idx
oneKgPhase1IndelsVcf,${bundle}/1000G_phase1.indels.b37.vcf
oneKgPhase1IndelsVcfIdx,${oneKgPhase1IndelsVcf}.idx

#phase 3 indels / snps
#${resDir}/${genomeBuild}/variants/1000G_Phase3/ALL.wgs.phase3_shapeit2_mvncall_integrated_v5.20130502.sites.vcf.gz

dbsnpVcf,${bundle}/dbsnp_138.b37.vcf
dbsnpVcfIdx,${dbsnpVcf}.idx

exacVcf,${data}/ExAC/release0.3/ExAC.r0.3.sites.vep.vcf.gz
exacVcfIdx,${exacVcf}.tbi

#limit to known realignment when using haplotype caller because the haplotypecaller will consider multiple haplotypes instead of one when the GatkRealignerTargetCreator step is used.
#indelRealignmentTargets,${data}/intervals/1000G_phase1.indels_Mills_and_1000G_gold_standard.indels.b37.human_g1k_v37.intervals
indelRealignmentTargets,${bundle}/Mills_and_1000G_gold_standard.indels.b37.vcf
#snpEff / snipsift
snpEffStats,${annotatorDir}/${project}.snpEff.summary.html

#snpEff database resources...
motifBin,${data}/snpEff/GRCh37.75/motif.bin
nextProtBin,${data}/snpEff/GRCh37.75/nextProt.bin
pwmsBin,${data}/snpEff/GRCh37.75/pwms.bin
regulation_CD4Bin,${data}/snpEff/GRCh37.75/regulation_CD4.bin
regulation_GM06990Bin,${data}/snpEff/GRCh37.75/regulation_GM06990.bin
regulation_GM12878Bin,${data}/snpEff/GRCh37.75/regulation_GM12878.bin
regulation_H1ESCBin,${data}/snpEff/GRCh37.75/regulation_H1ESC.bin
regulation_HeLaS3Bin,${data}/snpEff/GRCh37.75/regulation_HeLa-S3.bin
regulation_HepG2Bin,${data}/snpEff/GRCh37.75/regulation_HepG2.bin
regulation_HMECBin,${data}/snpEff/GRCh37.75/regulation_HMEC.bin
regulation_HSMMBin,${data}/snpEff/GRCh37.75/regulation_HSMM.bin
regulation_HUVECBin,${data}/snpEff/GRCh37.75/regulation_HUVEC.bin
regulation_IMR90Bin,${data}/snpEff/GRCh37.75/regulation_IMR90.bin
#regulation_K562bBin,${data}/snpEff/GRCh37.75/regulation_K562b.bin
regulation_K562Bin,${data}/snpEff/GRCh37.75/regulation_K562.bin
regulation_NHABin,${data}/snpEff/GRCh37.75/regulation_NH-A.bin
regulation_NHEKBin,${data}/snpEff/GRCh37.75/regulation_NHEK.bin
snpEffectPredictorBin,${data}/snpEff/GRCh37.75/snpEffectPredictor.bin

#snpSift database resources
dbnsfp,${data}/dbNSFP/2.7/dbNSFP2.7.txt.gz
dbnsfpTbi,${dbnsfp}.tbi

#vcf
oneKgP1wgsVcf,${data}/ftp-trace.ncbi.nih.gov/1000genomes/ftp/release/20130502/ALL.wgs.phase3_shapeit2_mvncall_integrated_v5b.20130502.sites.vcf.gz
oneKgP1wgsVcfIdx,${oneKgP1wgsVcf}.tbi
cosmicDir,${data}/sftp-cancer.sanger.ac.uk/files/grch37/cosmic/

cosmicVersion,v72
cosmicVcf,${cosmicDir}/${cosmicVersion}/VCF/CosmicCodingMuts.bundle_2.8_b37.vcf.gz
cosmicVcfIdx,${cosmicVcf}.tbi

#customscript
#normalAnnotPl,/gcc/tools/scripts/Vcf_tools_misc/ForGerardTeMeermanVcfAnnotation0.0.2.pl
normalAnnotPl,ForGerardTeMeermanVcfAnnotation.pl

#nugene barcode
nugBcSplitterPl,NugeneDigitalSplitter.pl
#

#
GenerateTableDescriptionByVcfHeaderPl,GenerateTableDescriptionByVcfHeader.pl

RVersion,3.0.2
vcfToolsVersion,0.1.12a

plotScriptPl,PlotFloatsOnInterVals.pl

################################################################################
#CreatePaddedIntervals + padding
#targetsList,/gcc/groups/oncogenetics/tmp01/resources/target_ET1262F_2_182.ensembl.gatksort.list
slopTargetsList,${projectDir}/targets.slop100.list
#targetsList,/gcc/groups/oncogenetics/tmp01/resources/cancerPanel_target.ensembl.gatksort.list
scatterIntervallistDir,${projectDir}/scatter/
scatterList,${projectDir}/scatter/temp_${scatterIDs}_of_*/scattered.intervals 
#rna
genesRefFlat,${data}/ftp.ensembl.org/pub/release-${ensemblVersion}/gtf/homo_sapiens/${genomeLatSpecies}.${genomeGrchBuild}.${ensemblVersion}.refflat
rRnaIntervalList,${data}/ftp.ensembl.org/pub/release-${ensemblVersion}/gtf/homo_sapiens/${genomeLatSpecies}.${genomeGrchBuild}.${ensemblVersion}.rrna.interval_list
ensemblAnnotationGtf,${data}/ftp.ensembl.org/pub/release-${ensemblVersion}/gtf/homo_sapiens/${genomeLatSpecies}.${genomeGrchBuild}.${ensemblVersion}.gtf
################################################################################
##Fastqc
#
fastqcDir,${projectDir}/fastqc/
fastqcZipExt,_fastqc.zip
singleEndfastqcZip,${fastqcDir}/${internalId}_${sampleName}.fq${fastqcZipExt}
pairedEndfastqcZip1,${fastqcDir}/${internalId}_${sampleName}_1.fq${fastqcZipExt}
pairedEndfastqcZip2,${fastqcDir}/${internalId}_${sampleName}_2.fq${fastqcZipExt}
################################################################################
##Nugene random fastq integration/bbduk trimming
nugeneFastqDir,${projectDir}/nugeneFastq/

nugeneReads1FqGz,${nugeneFastqDir}/${internalId}_${sampleName}_1.fq.gz
nugeneReads2FqGz,${nugeneFastqDir}/${internalId}_${sampleName}_2.fq.gz

probeFa,/groups/umcg-oncogenetics/tmp04/res/probeSeq_RDonly_ET1262F_2_182.rc.fasta
probeBed,/groups/umcg-oncogenetics/tmp04/res/probeSeq_RDonly_ET1262F_2_182.bed
################################################################################
##Nugene random fastq integration/bbduk trimming
nugeneProbeMetricsDir,${projectDir}/nugeneProbeMetrics/
nugeneProbeMetricsLog,${nugeneProbeMetricsDir}/${sampleName}.probemetrics.tsv


##################################
##remappable name for sample md generation
#
fastqcCleanDir,${nugeneFastqDir}
################################################################################
##General/bwa
#
nTreads,8
bwaAlignmentDir,${projectDir}/bwa/
bwaSam,${bwaAlignmentDir}${internalId}_${sampleName}.sam
reads1FqGzOriginal,${reads1FqGz}
reads2FqGzOriginal,${reads2FqGz}

################################################################################
##hisat2
#
hisat2AlignmentDir,${projectDir}/hisat2/
hisat2Sam,${hisat2AlignmentDir}${internalId}_${sampleName}.sam
hisat2IdxBase,${bundle}/hisat2/2.0.3-beta-goolf-1.7.20/human_g1k_v37_decoy
gatkOpt,

################################################################################
##AddOrReplaceGroups
#
addOrReplaceGroupsDir,${projectDir}/addOrReplaceReadGroups/
addOrReplaceGroupsBam,${addOrReplaceGroupsDir}${internalId}_${sampleName}.bam
addOrReplaceGroupsBai,${addOrReplaceGroupsDir}${internalId}_${sampleName}.bai
#
################################################################################
#Nugene Bc Splitter?
#
#nugBcSplitterPl,/gcc/groups/oncogenetics/tmp01/tools/NugeneBarcodesAsReadgroup/dist/NugeneDigitalSplitter.pl
nugeneRgDir,${projectDir}/nugeneReadgroups/
nugeneBam,${nugeneRgDir}${internalId}_${sampleName}.bam
nugeneBai,${nugeneRgDir}${internalId}_${sampleName}.bai
#
################################################################################
##MergeBamFiles ?? #note the actual picard programme: MergeSamFiles.jar
mergeBamFilesDir,${projectDir}/MergeBams/
mergeBamFilesBam,${mergeBamFilesDir}${sampleName}.bam
mergeBamFilesBai,${mergeBamFilesDir}${sampleName}.bai
#
################################################################################
##MarkDuplicates
#
markDuplicatesDir,${projectDir}/markDuplicates/
markDuplicatesBam,${markDuplicatesDir}${sampleName}.bam
markDuplicatesBai,${markDuplicatesDir}${sampleName}.bai
markDuplicatesMetrics,${markDuplicatesDir}${sampleName}.metrics.log
#
################################################################################
##Htseq-count before and after markduplicates
#
htseqDir,${projectDir}/htseq/
htseqTsv,${htseqDir}${sampleName}.tsv

htseqDupsDir,${projectDir}/htseqdups/
htseqDupsTsv,${htseqDupsDir}${sampleName}.tsv

################################################################################
##CollectRnaSeqMetrics
#
collectRnaSeqMetricsDir,${projectDir}/collectRnaSeqMetrics/
collectRnaSeqMetrics,${collectRnaSeqMetricsDir}${sampleName}.rna_metrics.log
collectRnaSeqMetricsChart,${collectRnaSeqMetricsDir}${sampleName}.chart.pdf

################################################################################
##CollectMultipleMetrics

collectMultipleMetricsDir,${projectDir}/multipleMetrics/
collectMultipleMetricsPrefix,${collectMultipleMetricsDir}/${sampleName}
################################################################################
##CalculateHsMetrics bed files

calculateHsMetricsDir,${projectDir}/HsMetrics/
calculateHsMetricsLog, ${calculateHsMetricsDir}/${sampleName}.hsmetrics.log
calculateHsMetricsPerTargetCov, ${calculateHsMetricsDir}/${sampleName}.hsmetrics.pertargetcov.tsv
################################################################################
#GatkSplitAndTrim

splitAndTrimDir,${projectDir}/splitAndTrim/
splitAndTrimBam,${splitAndTrimDir}${sampleName}.bam
splitAndTrimBai,${splitAndTrimDir}${sampleName}.bai
#gatkOpt=allowNCigarReads;
allowNCigarReads," -U ALLOW_N_CIGAR_READS "

################################################################################
#GatkRealignerTargetCreator

#because want to use alternative not local assembling callers on the same data like mutect/varscan etc

indelRealignmentDir,${projectDir}/indelRealignment/
realignmentIntervals,${indelRealignmentDir}/realignmentIntervals.list


################################################################################
#IndelRealigner
indelRealignmentBam,${indelRealignmentDir}${sampleName}.bam
indelRealignmentBai,${indelRealignmentDir}${sampleName}.bai
##############################################################################
#BSQR(+PrintReads) default
bqsrDir,${projectDir}/baseQualityScoreRecalibration/

bqsrBam,${bqsrDir}${sampleName}.bam
bqsrBai,${bqsrDir}${sampleName}.bai
bqsrBeforeGrp,${bqsrDir}${sampleName}.before.grp

################################################################################
#(BSQR+)AnalyseCovariants default
analyseCovarsDir,${projectDir}/CovariantAnalysis/
bqsrAfterGrp,${bqsrDir}${sampleName}.after.grp

analyseCovariatesPdf,${analyseCovarsDir}/${sampleName}.analysecovariates.pdf

################################################################################
#haplotypecaller
haplotyperDir,${projectDir}/haplotypeCaller/
haplotyperRealignmentBam,${haplotyperDir}${sampleName}.bam
haplotyperRealignmentBai,${haplotyperDir}${sampleName}.bam
haplotyperScatVcf,${haplotyperDir}${project}.${scatterIDs}.vcf
haplotyperScatVcfIdx,${haplotyperScatVcf}.idx
haplotyperVcf,${haplotyperDir}${project}.vcf
haplotyperVcfIdx,${haplotyperVcf}.idx
################################################################################
#variant annotation

annotatorDir,${projectDir}/VariantAnnotation/

snpEffGatkAnnotVcf,${annotatorDir}/${project}.snpEffGatk.intermediate.vcf
snpEffGatkAnnotVcfIdx,${snpEffGatkAnnotVcf}.idx
gatkAnnotVcf,${annotatorDir}/${project}.annot.intermediate.vcf
gatkAnnotVcfIdx,${gatkAnnotVcf}.idx
snpEffAnnotVcf,${annotatorDir}/${project}.snpEff.intermediate.vcf
snpEffAnnotVcfIdx,${snpEffAnnotVcf}.idx
#
#snpSiftAnnotVcf,${annotatorDir}/${project}.snpEffGatk.intermediate.vcf
#snpSiftAnnotVcfIdx,${snpSiftAnnotVcf}.idx
#
annotVcf,${annotatorDir}/${project}.annot.vcf
annotVcfIdx,${annotVcf}.idx


#custAnnotVcf,${annotatorDir}/${project}.annot.cust.${controlSampleName}.vcf
#custAnnotVcfIdx,${custAnnotVcf}.idx

################################################################################
#switch custom annotation around!!!!!!!!!!!!
#variant filtration
#variantFiltDir,${projectDir}/variantfiltering/
#select INDELS & MNP / SNVS
#snvRawVcf,${variantFiltDir}/${project}.snv.raw.vcf
#snvRawVcfIdx,${snvRawVcf}.idx
#indelMnpRawVcf,${variantFiltDir}/${project}.indelmnp.raw.vcf
#indelMnpRawVcfIdx,${indelMnpRawVcf}.idx
#and filtered
#snvVcf,${variantFiltDir}/${project}.snv.vcf
#snvVcfIdx,${snvVcf}.idx
#indelMnpVcf,${variantFiltDir}/${project}.indelmnp.vcf
#indelMnpVcfIdx,${indelMnpVcf}.idx

#customscript
#normalAnnotPl,/gcc/tools/scripts/Vcf_tools_misc/ForGerardTeMeermanVcfAnnotation0.0.2.pl
custAnnotVcf,${annotatorDir}/${project}.annot.cust.${controlSampleName}.vcf
custAnnotVcfIdx,${custAnnotVcf}.idx

################################################################################
#variant filtration
variantFiltDir,${projectDir}/variantfiltering/
#select INDELS & MNP / SNVS
snvRawVcf,${variantFiltDir}/${project}.${controlSampleName}.snv.raw.vcf
snvRawVcfIdx,${snvRawVcf}.idx
indelMnpRawVcf,${variantFiltDir}/${project}.${controlSampleName}.indelmnp.raw.vcf
indelMnpRawVcfIdx,${indelMnpRawVcf}.idx
#and filtered
snvVcf,${variantFiltDir}/${project}.${controlSampleName}.snv.vcf
snvVcfIdx,${snvVcf}.idx
indelMnpVcf,${variantFiltDir}/${project}.${controlSampleName}.indelmnp.vcf
indelMnpVcfIdx,${indelMnpVcf}.idx

################################################################################
#variants to table
tableDir,${projectDir}/tables/
#variantTable,${tableDir}/${project}.tsv
snvTable,${tableDir}/${project}.${controlSampleName}.snv.tsv
indelMnpTable,${tableDir}/${project}.${controlSampleName}.indelmnp.tsv
snvRawTable,${tableDir}/${project}.${controlSampleName}.snv.raw.tsv
indelMnpRawTable,${tableDir}/${project}.${controlSampleName}.indelmnp.raw.tsv

################################################################################
#vcf to descriptiontable
#GenerateTableDescriptionByVcfHeaderPl,GenerateTableDescriptionByVcfHeader.pl
snvDescrTable,${tableDir}/${project}.snv.description.tsv
indelMnpDescrTable,${tableDir}/${project}.indelmnp.description.tsv
################################################################################
#tables to xlsx
xlsxDir,${projectDir}/xlsx/
snvXlsx,${xlsxDir}/${project}.${controlSampleName}.snv.xlsx
indelMnpXlsx,${xlsxDir}/${project}.${controlSampleName}.indelmnp.xlsx
snvRawXlsx,${xlsxDir}/${project}.${controlSampleName}.snv.raw.xlsx
indelMnpRawXlsx,${xlsxDir}/${project}.${controlSampleName}.indelmnp.raw.xlsx
snvDescrXlsx,${xlsxDir}/${project}.snv.description.xlsx
indelMnpDescrXlsx,${xlsxDir}/${project}.indelmnp.description.xlsx
################################################################################
#haplotypecaller + Gvcf mode
gHaplotyperDir,${projectDir}/haplotypeCallerGvf/
haplotyperGvcf,${gHaplotyperDir}${sampleName}.g.vcf
haplotyperGvcfIdx,${haplotyperGvcf}.idx
################################################################################
#mergeGvcfs
mergeGvcf,${gHaplotyperDir}${project}.g.vcf
mergeGvcfIdx,${mergeGvcf}.idx
################################################################################
#genotypeGvcf
genotypedVcf,${gHaplotyperDir}${project}.gg.vcf
genotypedVcfIdx,${genotypedVcf}.idx
################################################################################
#gvcf variant annotation extra parameters
gannotatorDir,${projectDir}/GVariantAnnotation/
gsnpEffVcf,${gannotatorDir}/${project}.snpEff.vcf
gsnpEffVcfIdx,${gsnpEffVcf}.idx
gannotVcf,${gannotatorDir}/${project}.annot.vcf
gannotVcfIdx,${gannotVcf}.idx



################################################################################
#varscan files
varscanDir,${projectDir}/varscan.${controlSampleName}/
varscanCopynumberPrefix,${varscanDir}/${sampleName}.cn
varscanCopynumber,${varscanCopynumberPrefix}.copynumber
varscanCopycaller,${varscanCopynumberPrefix}.called
varscanCopycallerHomdels,${varscanCopynumberPrefix}.called.homdels


varscanInputBam,${indelRealignmentBam}
varscanInputBai,${indelRealignmentBai}
varscanInputBamBai,${indelRealignmentBam}

#same as indelRealignmentBam,${indelRealignmentDir}${sampleName}.bam

controlvarscanInputBam,${indelRealignmentDir}${controlSampleName}.bam
controlvarscanInputBai,${indelRealignmentDir}${controlSampleName}.bai
controlvarscanInputBamBai,${indelRealignmentDir}${controlSampleName}.bai

#
#
################################################################################
#PlotGenome?

segFile,${varscanDir}/${sampleName}.seg
segmentsPlotPdf,${varscanDir}/${sampleName}.cn.called.pdf
cnvPlotPdf,${varscanDir}/${sampleName}.cn.called.pdf

scriptDir,/gcc/tools/scripts/

#lazyAnnotScriptPl,${scriptDir}//PlotVarscan/VcfaddAdBasedZScores.pl
#gCustomAnnotVcf,${varscanDir}/${project}.custannot.vcf



################################################################################
#CreateProjectMd aka CreateProjectMarkdown
#
sampleMarkdownDir,${projectDir}/md/
sampleMarkdown,${sampleMarkdownDir}/${project}.${sampleName}.md

projectMarkdown,${projectDir}/${project}.summary.Rmd
#
#
#test projectsamplesheet
#project,sampleName,sampleprep,barcode,seqtype,sequencer,reads1FqGz,reads2FqGz
#test,samplePE,000001,AAAAAA,illumina,hiseq2500,/gcc/groups/oncogenetics/${tmp}/projects/resourcesRNASeq/head_40000_120830_SN163_0474_BD0WDYACXX_L5_ACTGAT_1.fq.gz,/gcc/groups/oncogenetics/${tmp}/projects/resourcesRNASeq/head_40000_120830_SN163_0474_BD0WDYACXX_L5_ACTGAT_2.fq.gz
#test,sampleSE,000001,AAAAAA,illumina,hiseq2500,/gcc/groups/oncogenetics/${tmp}/projects/resourcesRNASeq/head_40000_120830_SN163_0474_BD0WDYACXX_L5_ACTGAT_1.fq.gz,
#
################################################################################
#Misc
snvWithPolymorficVcf,${variantFiltDir}/${project}.${controlSampleName}.withpoly.snv.vcf
snvWithPolymorficVcfIdx,${snvWithPolymorficVcf}.idx

indelMnpWithPolymorficVcf,${variantFiltDir}/${project}.${controlSampleName}.withpoly.indelmnp.vcf
indelMnpWithPolymorficVcfIdx,${indelMnpWithPolymorficVcf}.idx

