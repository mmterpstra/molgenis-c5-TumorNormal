step,protocol,dependencies
CreatePaddedTargets,protocols/CreatePaddedTargets.sh,
Fastqc,protocols/Fastqc.sh,
TrimGalore,protocols/TrimGalore.sh,
FusionCatcher,protocols/FusionCatcher.sh,TrimGalore;reads1FqGz=trimgalore1FqGz;reads2FqGz=trimgalore2FqGz
#Hisat2Alignment,protocols/Hisat2.sh,onekgGenomeFastaIdxBase=hisat2IdxBase
StarIndex,protocols/STARindex.sh,
StarAlignment,protocols/STAR.sh,StarIndex;TrimGalore;reads1FqGz=trimgalore1FqGz;reads2FqGz=trimgalore2FqGz
AddOrReplaceReadGroups,protocols/AddOrReplaceReadGroups.sh,StarAlignment;bwaSam=starSam
MergeBamFiles,protocols/MergeBamFiles.sh,AddOrReplaceReadGroups;reads1FqGz=trimgalore1FqGz;reads2FqGz=trimgalore2FqGz
HtseqCountDups,protocols/HtseqCount.sh,MergeBamFiles;markDuplicatesBam=mergeBamFilesBam;markDuplicatesBai=mergeBamFilesBai;htseqDir=htseqDupsDir;htseqTsv=htseqDupsTsv
#ABRA2,protocols/ABRA2.sh,MergeBamFiles
MarkDuplicates,protocols/MarkDuplicates.sh,MergeBamFiles
#Manta,protocols/MantaSV.sh,MarkDuplicates;mantaConfigType=mantaConfigTypeRna
HtseqCount,protocols/HtseqCount.sh,MarkDuplicates
CollectMultipleMetrics,protocols/CollectMultipleMetrics.sh,MarkDuplicates
CalculateHsMetrics,protocols/CalculateHsMetrics.sh,MarkDuplicates
SampleMarkdown,protocols/SampleMarkdown.sh,CalculateHsMetrics;CollectMultipleMetrics;Fastqc;MarkDuplicates;fastqcCleanDir=fastqcDir;reads1FqGzClean=reads1FqGz;reads2FqGzClean=reads2FqGz
SplitAndTrim,protocols/GatkSplitAndTrim.sh,MarkDuplicates;gatkOpt=allowNCigarReads
IndelRealignmentKnown,protocols/GatkIndelRealignmentKnown.sh,SplitAndTrim;markDuplicatesBam=splitAndTrimBam;markDuplicatesBai=splitAndTrimBai;gatkOpt=allowNCigarReads
BQSR,protocols/GatkBQSR.sh,IndelRealignmentKnown;gatkOpt=allowNCigarReads
AnalyseCovariants,protocols/GatkAnalyseCovariants.sh,BQSR;gatkOpt=allowNCigarReads
Viterbi,protocols/LofreqViterbi.sh,IndelRealignmentKnown;bqsrBam=indelRealignmentBam;bqsrBai=indelRealignmentBai;
Lofreq,protocols/Lofreq.sh,Viterbi
CombineControlSamplesLofreq,protocols/GatkCombineControlSamples.sh,Lancet;sampleVcfDir=lofreqDir;controlSamplesVcf=lofreqScatVcf;sampleVcf=lofreqSampleControlsMergedVcf;sampleVcfIdx=lofreqSampleControlsMergedVcfIdx
ContEst,protocols/GatkContEst.sh,IndelRealignmentKnown
Mutect2Pon,protocols/GatkMutect2.sh,IndelRealignmentKnown;MergeBamFilesFreebayes;mutect2Dir=mutect2PonDir;mutect2ScatVcf=mutect2PonScatVcf;mutect2ScatVcfIdx=mutect2PonScatVcfIdx;controlSampleBam=controlSampleBam;controlSampleBai=controlSampleBai;indelRealignmentBam=controlSampleBam;indelRealignmentBai=controlSampleBai
#CombineControlSamplesMutect2PonWip,protocols/GatkCombineControlSamples.sh,Mutect2;sampleVcfDir=mutect2Dir;controlSamplesVcf=mutect2ScatVcf;sampleVcf=mutect2SampleControlsMergedVcf;sampleVcfIdx=mutect2SampleControlsMergedVcfIdx
MergeMutect2PonVariantsByProject,protocols/GatkCombineMutectSamples.sh,Mutect2Pon;mutect2SampleVcf=mutect2PonScatVcf;mutect2Vcf=mutect2PonProjectScatVcf;mutect2VcfIdx=mutect2PonProjectScatVcfIdx
Mutect2,protocols/GatkMutect2.sh,Mutect2Pon;MergeMutect2PonVariantsByProject;IndelRealignmentKnown;CreatePaddedTargets
CombineControlSamplesMutect2,protocols/GatkCombineControlSamples.sh,Mutect2;sampleVcfDir=mutect2Dir;controlSamplesVcf=mutect2ScatVcf;sampleVcf=mutect2SampleControlsMergedVcf;sampleVcfIdx=mutect2SampleControlsMergedVcfIdx
Lancet,protocols/Lancet.sh,IndelRealignmentKnown;CreatePaddedTargets
CombineControlSamplesLancet,protocols/GatkCombineControlSamples.sh,Lancet;sampleVcfDir=lancetDir;controlSamplesVcf=lancetScatVcf;sampleVcf=lancetSampleControlsMergedVcf;sampleVcfIdx=lancetSampleControlsMergedVcfIdx
#Mutect2,protocols/GatkMutect2.sh,ContEst;IndelRealignmentKnown
#MergeMutect2VariantsBySample,protocols/MergeVcfs.sh,Mutect2;haplotyperScatVcf=mutect2ScatVcf;haplotyperVcf=mutect2SampleVcf
#MergeMutect2VariantsByProject,protocols/GatkCombineMutectSamples.sh,MergeMutect2VariantsBySample
#HaplotypeCaller,protocols/GatkHaplotypeCaller.sh,BQSR;CreatePaddedTargets
#Catvariants,protocols/CatVariants.sh,HaplotypeCaller
#MergeVariants,protocols/MergeVcfs.sh,HaplotypeCaller
HaplotypeCallerGvcf,protocols/GatkHaplotypeCallerGvcf2.sh,IndelRealignmentKnown;bqsrBam=indelRealignmentBam;bqsrBai=indelRealignmentBai;CreatePaddedTargets
#MergeGvcfs,protocols/GatkMergeGvcfs.sh,HaplotypeCallerGvcf
CombineGvcfs,protocols/GatkCombineGvcfs.sh,HaplotypeCallerGvcf
GenotypeGvcfs,protocols/GatkGenotypeGvcfs.sh,HaplotypeCallerGvcf;CombineGvcfs
MergeBamFilesFreebayes,protocols/MergeBamFiles.sh,IndelRealignmentKnown;addOrReplaceReadGroupsBam=indelRealignmentBam;addOrReplaceReadGroupsBai=indelRealignmentBai;mergeBamFilesDir=freebayesDir;mergeBamFilesBam=freebayesProjectBam;mergeBamFilesBai=freebayesProjectBai
Freebayes,protocols/Freebayes.sh,MergeBamFilesFreebayes;CreatePaddedTargets
#MergeFreeBayesVariants,protocols/MergeVcfs.sh,Freebayes;haplotyperScatVcf=freebayesScatVcf;haplotyperVcf=freebayesVcf
MergeMutect2VariantsByProject,protocols/GatkCombineMutectSamples.sh,CombineControlSamplesMutect2;Mutect2;mutect2SampleVcf=mutect2SampleControlsMergedVcf;mutect2Vcf=mutect2ProjectScatVcf;mutect2VcfIdx=mutect2ProjectScatVcfIdx;
MergeLofreqVariantsByProject,protocols/GatkCombineMutectSamples.sh,CombineControlSamplesLofreq;Lofreq;mutect2Dir=lofreqDir;mutect2SampleVcf=lancetSampleControlsMergedVcf;mutect2Vcf=lofreqProjectScatVcf;mutect2VcfIdx=lofreqProjectScatVcfIdx;
MergeLancetVariantsByProject,protocols/GatkCombineMutectSamples.sh,CombineControlSamplesLancet;Lancet;mutect2Dir=lancetDir;mutect2SampleVcf=lancetSampleControlsMergedVcf;mutect2Vcf=lancetProjectScatVcf;mutect2VcfIdx=lancetProjectScatVcfIdx;
CombineVariants,protocols/GatkCombineVariants.sh,Freebayes;CombineGvcfs;MergeMutect2VariantsByProject;MergeLofreqVariantsByProject;bqsrBam=indelRealignmentBam;bqsrBai=indelRealignmentBai;haplotyperVcf=genotypedScatVcf;freebayesVcf=freebayesScatVcf;mutect2Vcf=mutect2ProjectScatVcf;lofreqVcf=lofreqProjectScatVcf;lancetVcf=lancetProjectScatVcf;combineVcf=combineScatVcf
MergeVariants,protocols/MergeVcfs.sh,CombineVariants;haplotyperScatVcf=combineScatVcf;haplotyperVcf=combineVcf
VariantAnnotation,protocols/GatkSnpEffVariantAnnotation.sh,MergeVariants;haplotyperVcf=combineVcf;haplotyperVcfIdx=combineVcfIdx;gatkOpt=allowNCigarReads
CustTumorNormalAnnotations,protocols/CustTumorNormalAnnotations.sh,VariantAnnotation
SelectIndels,protocols/GatkSelectIndels.sh,CustTumorNormalAnnotations
SelectSNV,protocols/GatkSelectSNV.sh,CustTumorNormalAnnotations
IndelVariantsToTable,protocols/GatkVariantsToTable.sh,SelectIndels;vcf=indelMnpVcf;variantTable=indelMnpTable;variantRawTable=indelMnpRawTable
IndelVariantsToMinTable,protocols/GatkVariantsToTable.sh,SelectIndels;vcf=indelMnpVcf;variantTable=indelMnpMinTable;variantRawTable=indelMnpMinRawTable;variantFields=variantFieldsLimited
SNVVariantsToTable,protocols/GatkVariantsToTable.sh,SelectSNV;vcf=snvVcf;variantTable=snvTable;variantRawTable=snvRawTable
SNVVariantsToMinTable,protocols/GatkVariantsToTable.sh,SelectSNV;vcf=snvVcf;variantTable=snvMinTable;variantRawTable=snvMinRawTable;variantFields=variantFieldsLimited
IndelVariantsToDescriptionTable,protocols/GenerateTableDescr.sh,SelectIndels;vcf=indelMnpVcf;descrTable=indelMnpDescrTable
SNVVariantsToDescriptionTable,protocols/GenerateTableDescr.sh,SelectSNV;vcf=snvVcf;descrTable=snvDescrTable
TablesToSplitTables,protocols/TablesToSplitTables.sh,SNVVariantsToDescriptionTable;IndelVariantsToDescriptionTable;SNVVariantsToMinTable;SNVVariantsToTable;IndelVariantsToMinTable;IndelVariantsToTable;
TablesToXlsx,protocols/TablesToXlsx.sh,IndelVariantsToTable;SNVVariantsToTable;SNVVariantsToDescriptionTable;IndelVariantsToDescriptionTable
CnvProfile,protocols/CnvkitCNV.sh,MergeVariants;IndelRealignmentKnown;bqsrBam=indelRealignmentBam;bqsrBai=indelRealignmentBai
Varscan2,protocols/Varscan2.sh,IndelRealignmentKnown;HaplotypeCaller
PlotGenome,protocols/Plotgenome.sh,Varscan2;SNVVariantsToTable
MergeSegFiles,protocols/MergeSegFiles.sh,PlotGenome
ProjectMarkdown,protocols/ProjectMarkdown.sh,SampleMarkdown
MultiQC,protocols/MultiQC.sh,ProjectMarkdown;SelectIndels;SelectSNV;SamQC;VariantAnnotation
Cleanup,protocols/CleanUpProject.sh,TablesToXlsx;CalculateHsMetrics;CollectMultipleMetrics;Fastqc;AnalyseCovariants;TablesToXlsx;HaplotypeCaller;TablesToSplitTables